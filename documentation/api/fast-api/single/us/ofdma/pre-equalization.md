# PNM Operations ‚Äì Upstream OFDMA Pre-Equalization

## üìõ Table of Contents

* [Get Measurement](#get-measurement)
* [Get Analysis](#get-analysis)
* [Analysis and Output Types](#analysis-and-output-types)


## Get Measurement

### üõ∞ Endpoint

**POST** `/docs/pnm/us/ofdma/preEqualization/getMeasurement`

Retrieves OFDMA upstream pre-equalization complex coefficients from a DOCSIS 3.1 cable modem for PNM diagnostics.

### üë• Request Body (JSON)

```json
{
  "mac_address": "aa:bb:cc:dd:ee:ff",
  "ip_address": "192.168.0.100",
  "snmp": {
    "snmpV2C": {
      "community": "private"
    },
    "snmpV3": {
      "username": "string",
      "securityLevel": "noAuthNoPriv",
      "authProtocol": "MD5",
      "authPassword": "string",
      "privProtocol": "DES",
      "privPassword": "string"
    }
  }
}
```

### üîë Fields

| Field        | Type   | Description                    |
| ------------ | ------ | ------------------------------ |
| mac\_address | string | MAC address of the cable modem |
| ip\_address  | string | IP address of the cable modem  |
| snmp         | object | SNMPv2c or SNMPv3 credentials  |

### üìÑ Response Body (Object)

```json
{
  "mac_address": "aa:bb:cc:dd:ee:ff",
  "status": 0,
  "message": null,
  "measurement": {
    "data": [
      {
        "status": "SUCCESS",
        "pnm_header": {
          "file_type": "PNN",
          "file_type_version": 6,
          "major_version": 1,
          "minor_version": 0,
          "capture_time": 1751781817
        },
        "upstream_channel_id": 42,
        "cm_mac_address": "aa:bb:cc:dd:ee:ff",
        "cmts_mac_address": "00:90:f0:01:00:00",
        "subcarrier_zero_frequency": 104800000,
        "first_active_subcarrier_index": 74,
        "subcarrier_spacing": 50000,
        "value_length": 7584,
        "value_unit": "[Real, Imaginary]",
        "values": [
          [1.0764, 0.6097],
          [..., ...]
        ]
      }
    ]
  }
}
```

### üìä Key Response Fields

| Field                              | Type    | Description                                 |
| ---------------------------------- | ------- | ------------------------------------------- |
| mac\_address                       | string  | MAC address used in the request             |
| status                             | integer | 0 = success                                 |
| measurement.data                   | array   | List of measurement entries per capture     |
| ‚Ü≥ status                           | string  | Capture status (e.g., "SUCCESS")            |
| ‚Ü≥ upstream\_channel\_id            | integer | Channel ID associated with this capture     |
| ‚Ü≥ cm\_mac\_address                 | string  | Cable modem MAC address                     |
| ‚Ü≥ cmts\_mac\_address               | string  | CMTS MAC address                            |
| ‚Ü≥ subcarrier\_zero\_frequency      | integer | Base frequency (Hz) of subcarrier 0         |
| ‚Ü≥ first\_active\_subcarrier\_index | integer | Index of first active subcarrier            |
| ‚Ü≥ subcarrier\_spacing              | integer | Frequency spacing between subcarriers in Hz |
| ‚Ü≥ value\_length                    | integer | Total number of subcarriers represented     |
| ‚Ü≥ value\_unit                      | string  | Format of data (e.g., \[Real, Imaginary])   |
| ‚Ü≥ values                           | array   | List of complex coefficient pairs           |

> ‚ÑπÔ∏è Each value represents a decoded complex tap coefficient used for plant characterization.

### üìç Notes

* This endpoint is part of the proactive diagnostics suite used to assess in-channel echo and group delay distortion.
* Each `values` array contains I/Q (real/imaginary) values per subcarrier.
* Timing information and versioning are provided via the `pnm_header` block.

## Get Analysis

### üõ∞ Endpoint

**POST** `/docs/pnm/us/ofdma/preEqualization/getAnalysis`

Returns statistical analysis of decoded upstream OFDMA pre-equalization coefficients for DOCSIS 3.1 cable modems.

### üë• Request Body (JSON)

```json
{
  "mac_address": "aa:bb:cc:dd:ee:ff",
  "ip_address": "192.168.0.100",
  "snmp": {
    "snmpV2C": {
      "community": "private"
    },
    "snmpV3": {
      "username": "string",
      "securityLevel": "noAuthNoPriv",
      "authProtocol": "MD5",
      "authPassword": "string",
      "privProtocol": "DES",
      "privPassword": "string"
    }
  },
  "analysis": {
    "type": 0
  },
  "output": {
    "type": 0
  }
}
```

### üîë Fields

| Field         | Type   | Description                                            |
| ------------- | ------ | ------------------------------------------------------ |
| mac\_address  | string | MAC address of the cable modem                         |
| ip\_address   | string | IP address of the cable modem                          |
| snmp          | object | SNMPv2c or SNMPv3 credentials                          |
| analysis.type | int    | 0 = basic                                              |
| output.type   | int    | 0 = json <br> 2 = xlsx                                 |

### üìÑ Response Body ‚Äì Output Type `0`

```json
{
  "mac_address": "aa:bb:cc:dd:ee:ff",
  "status": 0,
  "data": {
    "analysis": [
      {
        "pnm_header": {
          "file_type": "PNN",
          "file_type_version": 6,
          "major_version": 1,
          "minor_version": 0,
          "capture_time": 1751782748
        },
        "mac_address": null,
        "channel_id": null,
        "frequency_unit": "Hz",
        "magnitude_unit": "dB",
        "group_delay_unit": "microsecond",
        "complex_unit": "[Real, Imaginary]",
        "carrier_values": {
          "carrier_count": 1896,
          "frequency": [...],
          "magnitude": [...],
          "group_delay": [...],
          "complex": [[-1.9545, -1.0011]]
        }
      }
    ]
  }
}
```

### üìä Response Fields

| Field                | Type        | Description                                  |
| -------------------- | ----------- | -------------------------------------------- |
| mac\_address         | string      | MAC of the target modem                      |
| status               | int         | 0 = success                                  |
| data.analysis        | list        | List of OFDMA analysis entries               |
| ‚Ü≥ pnm\_header        | object      | Metadata about the measurement file          |
| ‚Ü≥ frequency\_unit    | string      | Unit for x-axis of frequency array           |
| ‚Ü≥ magnitude\_unit    | string      | Unit for RxMER/magnitude in dB               |
| ‚Ü≥ group\_delay\_unit | string      | Unit for group delay values                  |
| ‚Ü≥ complex\_unit      | string      | Format of the complex coefficients           |
| ‚Ü≥ carrier\_values    | object      | Actual subcarrier data and computed analysis |
| ‚Ü≥‚Ü≥ carrier\_count    | int         | Total number of OFDMA subcarriers            |
| ‚Ü≥‚Ü≥ frequency         | float\[]    | Array of subcarrier center frequencies (Hz)  |
| ‚Ü≥‚Ü≥ magnitude         | float\[]    | Array of magnitude values in dB              |
| ‚Ü≥‚Ü≥ group\_delay      | float\[]    | Group delay per subcarrier (Œºs)              |
| ‚Ü≥‚Ü≥ complex           | float\[]\[] | Complex I/Q tap coefficients per subcarrier  |

### üìç Notes

* This endpoint performs full-spectrum statistical analysis on captured OFDMA coefficients.
* Output type 0 is structured and suitable for plotting or CSV export.
* Group delay is computed from the phase slope across adjacent subcarriers.

## Analysis and Output Types

### `analysis.type`

| Value | Description                              |
| ----- | ---------------------------------------- |
| `0`   | Basic Magnitude and Group Delay Analysis |

### `output.type`

| Value | Format  | Description                                           |
| ----- | ------- | ----------------------------------------------------- |
| `0`   | JSON    | Structured data for dashboards or raw API consumption |
| `1`   | CSV     | Not Supported   |
| `2`   | XLSX    | (Planned) Taps overlay and echo/impulse view          |
